[gd_scene load_steps=12 format=3 uid="uid://cyl2jftnsfseb"]

[ext_resource type="PackedScene" uid="uid://dhnqhg7al0gbr" path="res://Player/rig.tscn" id="1_3ih25"]
[ext_resource type="Script" uid="uid://dp2ugunagnlvd" path="res://Enemies/enemy.gd" id="1_bxkaj"]
[ext_resource type="PackedScene" uid="uid://dry3c81yttw31" path="res://Assets/3D_Assets/Character/Gear/Tall_Shield.glb" id="2_8wvsg"]
[ext_resource type="PackedScene" uid="uid://c6pdm8b840545" path="res://Player/health_component.tscn" id="3_47qgu"]
[ext_resource type="PackedScene" uid="uid://c43n45klq0hda" path="res://Player/area_attack.tscn" id="3_572h1"]
[ext_resource type="PackedScene" uid="uid://d0vv46dvblrcv" path="res://Assets/3D_Assets/Character/Gear/Short_Shield.glb" id="3_gk8ng"]
[ext_resource type="PackedScene" uid="uid://cvkhlrrh1rsjj" path="res://Assets/3D_Assets/Character/Gear/Broken_Sword.glb" id="4_jlnat"]
[ext_resource type="PackedScene" uid="uid://ndcq32ajm26w" path="res://Assets/3D_Assets/Character/Gear/Longsword.glb" id="5_t8uwx"]
[ext_resource type="PackedScene" uid="uid://lserhyx2701q" path="res://Assets/3D_Assets/Character/Gear/Battleaxe.glb" id="6_tligp"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_bxkaj"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_47qgu"]

[node name="Enemy" type="CharacterBody3D"]
collision_layer = 9
script = ExtResource("1_bxkaj")
shields = Array[PackedScene]([ExtResource("2_8wvsg"), ExtResource("3_gk8ng")])
weapons = Array[PackedScene]([ExtResource("4_jlnat"), ExtResource("5_t8uwx"), ExtResource("6_tligp")])

[node name="NavigationAgent3D" type="NavigationAgent3D" parent="."]
avoidance_enabled = true
debug_enabled = true

[node name="HealthComponent" parent="." node_paths=PackedStringArray("body") instance=ExtResource("3_47qgu")]
body = NodePath("..")

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
shape = SubResource("CapsuleShape3D_bxkaj")

[node name="RigPivot" type="Node3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -1, 0)

[node name="Rig" parent="RigPivot" instance=ExtResource("1_3ih25")]

[node name="Skeleton3D" parent="RigPivot/Rig/CharacterRig/GameRig" index="0"]
bones/0/position = Vector3(4.440892e-15, 0.91064936, -0.048173565)
bones/2/rotation = Quaternion(0.007022396, -0.00027241567, 0.0032110768, 0.9999702)
bones/3/rotation = Quaternion(-0.08855767, -0.00027688156, 0.008524798, 0.9960346)
bones/4/rotation = Quaternion(0.26992166, 1.4405245e-08, 9.167822e-08, 0.96288234)
bones/6/rotation = Quaternion(-0.16514617, -1.1757251e-07, -1.968695e-08, 0.9862691)
bones/7/position = Vector3(-2.9790606e-08, 0.91064924, -0.048173457)
bones/8/position = Vector3(-6.254055e-08, 0.9106493, -0.04817354)
bones/9/position = Vector3(0.13114369, 0.9768536, -0.035129096)
bones/9/rotation = Quaternion(0.9943001, 0.020219503, -0.031261906, 0.09990628)
bones/11/rotation = Quaternion(0.3937464, -0.0006946798, 0.0002976909, 0.91921884)
bones/13/rotation = Quaternion(-0.74027056, 0.01184364, 0.0243587, 0.6717633)
bones/15/position = Vector3(-0.1311437, 0.9768535, -0.0351291)
bones/15/rotation = Quaternion(0.9759231, -0.005257081, 0.027686384, 0.21628657)
bones/17/rotation = Quaternion(0.42006978, 0.0031485045, -0.0014575118, 0.90748525)
bones/19/rotation = Quaternion(-0.67758435, -0.028135393, -0.0014854362, 0.73490524)
bones/21/position = Vector3(0.025128614, 1.4401739, 0.04734308)
bones/21/rotation = Quaternion(-0.46974587, -0.2675416, -0.41731384, 0.73048586)
bones/22/position = Vector3(0.19155447, 1.4792004, -0.00943397)
bones/22/rotation = Quaternion(0.020309558, -0.16416189, 0.97550493, -0.14501256)
bones/23/rotation = Quaternion(7.540319e-08, -0.040016558, 5.285896e-08, 0.9991991)
bones/24/rotation = Quaternion(0.35358417, -0.040035553, -0.022074731, 0.9342848)
bones/46/position = Vector3(-0.011363525, 1.4401739, 0.04734306)
bones/46/rotation = Quaternion(-0.46948206, 0.26595628, 0.41685537, 0.73149544)
bones/47/position = Vector3(-0.17759715, 1.479369, -0.009881726)
bones/47/rotation = Quaternion(-0.008527302, -0.14805995, 0.97607595, 0.15900116)
bones/48/rotation = Quaternion(-1.07942746e-07, 0.058596373, -9.804718e-08, 0.99828184)
bones/49/rotation = Quaternion(0.3945259, 0.058596816, 0.027807059, 0.91659284)
bones/71/position = Vector3(0.12719111, 1.3613825, -0.024382468)
bones/71/rotation = Quaternion(2.0333504e-08, 0.5980551, 0.80145496, -4.584027e-08)
bones/72/position = Vector3(-0.113425955, 1.3613825, -0.024382494)
bones/72/rotation = Quaternion(2.0333557e-08, 0.5980551, 0.80145496, -4.58402e-08)

[node name="Knight_02" parent="RigPivot/Rig/CharacterRig/GameRig/Skeleton3D" index="1"]
visible = false

[node name="Villager_01" parent="RigPivot/Rig/CharacterRig/GameRig/Skeleton3D" index="2"]
visible = true

[node name="RightHandBone" parent="RigPivot/Rig" index="2"]
transform = Transform3D(-0.9623439, -0.27079874, -0.023717098, 0.22054021, -0.82878137, 0.51428, -0.15892269, 0.48968366, 0.85729414, -0.35141298, 1.0134997, 0.03175444)

[node name="LeftHandBone" parent="RigPivot/Rig" index="3"]
transform = Transform3D(-0.9704711, 0.23925835, 0.03069027, -0.20839222, -0.8956679, 0.3928763, 0.12148723, 0.37487954, 0.91907877, 0.34840322, 0.9960303, -0.006051462)

[node name="PlayerDetector" type="ShapeCast3D" parent="RigPivot/Rig"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
shape = SubResource("CapsuleShape3D_47qgu")
target_position = Vector3(0, 0, 1)
collision_mask = 4

[node name="AreaAttack" parent="RigPivot/Rig" instance=ExtResource("3_572h1")]
target_position = Vector3(0, 1, 1)
collision_mask = 4

[connection signal="velocity_computed" from="NavigationAgent3D" to="." method="_on_navigation_agent_3d_velocity_computed"]
[connection signal="defeat" from="HealthComponent" to="." method="death"]
[connection signal="heavy_attack" from="RigPivot/Rig" to="." method="_on_rig_heavy_attack"]

[editable path="RigPivot/Rig"]
[editable path="RigPivot/Rig/CharacterRig"]
